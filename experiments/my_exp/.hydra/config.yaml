data_loader:
  train:
    total_batch_size: 16
    num_workers: 2
  val:
    total_batch_size: 4
    num_workers: 0
  test:
    total_batch_size: 16
    num_workers: 2
eval_only: false
weights: null
seed: 123
data:
  resolution: high
  size: 64k
  data_dir: data/abc/images/${data.resolution}/${data.size}
  data_label: image
  target_label: distances
  max_loaded_files: 5
model:
  model_name: PixelSegmentator
  params:
    feature_extractor:
      target: sharpf.modeling.Unet
      params:
        encoder_name: resnet50
        decoder_use_batchnorm: true
        decoder_channels:
        - 256
        - 128
        - 64
        - 32
        - 16
        decoder_attention_type: null
        in_channels: 1
    segmentation_head:
    - target: torch.nn.Conv2d
      params:
        in_channels: 16
        out_channels: 1
        kernel_size: 3
        padding: 1
    - target: torch.nn.Sigmoid
transforms:
  train:
  - target: sharpf.utils.abc_utils.torch.TypeCast
  val:
  - target: sharpf.utils.abc_utils.torch.TypeCast
  test:
  - target: sharpf.utils.abc_utils.torch.TypeCast
  normalisation:
  - data:
    - standartize
    - quantile
meta_arch:
  target: sharpf.modeling.DepthSegmentator
  monitor: val_balanced_accuracy
  loss:
    target: torch.nn.functional.binary_cross_entropy_with_logits
trainer:
  default_root_dir: null
  gradient_clip_val: 0.0
  process_position: 0
  num_nodes: 1
  num_processes: 1
  gpus: 1
  auto_select_gpus: false
  tpu_cores: null
  log_gpu_memory: null
  progress_bar_refresh_rate: 1
  overfit_batches: 0.0
  track_grad_norm: -1
  check_val_every_n_epoch: 1
  fast_dev_run: false
  accumulate_grad_batches: 1
  max_epochs: 1
  min_epochs: 1
  max_steps: null
  min_steps: null
  limit_train_batches: 1.0
  limit_val_batches: 1.0
  limit_test_batches: 1.0
  val_check_interval: 1.0
  log_save_interval: 100
  row_log_interval: 50
  distributed_backend: null
  precision: 32
  weights_summary: top
  weights_save_path: null
  num_sanity_val_steps: 2
  truncated_bptt_steps: null
  resume_from_checkpoint: null
  benchmark: false
  deterministic: false
  reload_dataloaders_every_epoch: false
  auto_lr_find: false
  replace_sampler_ddp: true
  terminate_on_nan: false
  auto_scale_batch_size: false
  prepare_data_per_node: true
  amp_level: O1
scheduler:
  target: torch.optim.lr_scheduler.StepLR
  params:
    step_size: 20
    gamma: 0.1
    last_epoch: -1
opt:
  target: torch.optim.Adam
  params:
    betas:
    - 0.9
    - 0.999
    lr: 0.001
    eps: 1.0e-08
    weight_decay: 0.0
    amsgrad: false
